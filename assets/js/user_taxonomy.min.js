"use strict";function validate_form(t){var e=new Array,a=0;return jQuery("#editusertaxonomy input, #editusertaxonomy textarea").each(function(){jQuery(this).is("textarea")||jQuery(this).val(),!input_value&&jQuery(this).attr("data-required")&&(jQuery(this).parents().eq(1).addClass("form-invalid"),e[a]=jQuery(this).attr("name"),a++)}),e}function insert_tags(t,e,a,n){var e=jQuery("#user-tags-"+e),s=e.val(),i=e.siblings(".tagchecklist");if(s){for(var o=s.split(","),r=!0,l=0;l<o.length;l++){var u=o[l];if(jQuery.trim(u)==jQuery.trim(a)){r=!1;break}}r&&(e.val(s+", "+a),i.append(n))}else e.val(a),i.append(n);t.val(""),jQuery("body .tag-suggestion").remove()}jQuery(document).ready(function(r){r("body").on("submit","#editusertaxonomy",function(t){return!validate_form().length}),r("#editusertaxonomy input").on("keyup",function(){jQuery(this).parents().eq(1).hasClass("form-invalid")&&($input_value=r(this).val())&&r(this).parents().eq(1).removeClass("form-invalid")}),r("body").on("click",".delete-taxonomy a",function(t){if(t.preventDefault(),!confirm("Delete taxonomy?"))return!1;var e=r(this),t=(t=e.attr("id"))&&(t=t.split("-"))[1],a=e.attr("data-name"),t=r("#delete-taxonomy-"+t).val();r.ajax({type:"POST",url:ajaxurl,data:{action:"ut_delete_taxonomy",delete_taxonomy:a,nonce:t},success:function(t){void 0!==t.success&&t.success?(r(".user-taxonomies-page h2:first").after('<div id="message" class="updated below-h2"><p>Taxonomy deleted.</p></div>'),e.parents().eq(3).remove(),setInterval(function(){r(".user-taxonomies-page #message.below-h2").hide("slow",function(){r(".user-taxonomies-page #message.below-h2").remove()})},1e4),r("#the-taxonomy-list tr").length||r("#the-taxonomy-list").append('<tr class="no-items"><td class="colspanchange" colspan="5">No Taxonomy found.</td></tr>')):(r(".user-taxonomies-page h2:first").after('<div id="message" class="error below-h2"><p>Taxonomy not deleted.</p></div>'),setInterval(function(){r(".user-taxonomies-page #message.below-h2").hide("slow",function(){r(".user-taxonomies-page #message.below-h2").remove()})},1e4))},error:function(t){console.log(t)}})});a=0;var a,t=function(t,e){clearTimeout(a),a=setTimeout(t,e)},e=(r(".user-profile-taxonomy").on("keyup",".newtag",function(){var e=r(this),a=e.val().split(",");2<=(a=r.trim(a[a.length-1])).length?t(function(){var t=e.attr("id").split("new-tag-user_tag_");r.ajax({type:"post",url:wp_ut.ajax_url,data:{action:"ut_load_tag_suggestions",tag:"user_tag",q:a,taxonomy:t[1],nonce:jQuery("#user-tags").val()},success:function(t){r(".tag-suggestion").remove(),t.success&&void 0!==t.data&&e.siblings("p.howto").before(t.data)},error:function(t){console.log(t)}})},200):jQuery(".tag-suggestion").remove()}),r("body").on("click",".tag-suggestion li",function(){var t=r(this),e="",a=t.html(),n=t.parent().siblings(".tagchecklist").length,s=t.parent().siblings(".newtag").attr("id"),s='<div class="tag-hldr"><a href="#" class="term-link">'+a+'</a><span><a id="user_tag-'+(e=s?(s=s.split("new-tag-user_tag_"))[1]:e)+"-check-num-"+n+'" class="ntdelbutton">&#10005;</a></span></div';insert_tags(t.parent().siblings(".newtag"),e,a,s)}),r(document).mouseup(function(t){var e=r(".hide-on-blur");e.is(t.target)||0!==e.has(t.target).length||r(".tag-suggestion").remove()}),r("body").on("click",".button.tagadd",function(){var t=r(this),e=t.siblings(".newtag");if(a=e.val()){for(var a=a.split(","),n=e.attr("id").split("new-tag-user_tag_")[1],s=t.siblings(".tagchecklist"),i=0;i<a.length;i++){var o=s.length,o='<div class="tag-hldr"><a href="#" class="term-link">'+a[i]+'</a><span><a id="post_tag-'+n+"-check-num-"+o+'" class="ntdelbutton">&#10005;</a></span></div>';insert_tags(e,n,a[i],o)}r(".tag-suggestion").remove()}}),r("body").on("click",".ntdelbutton",function(){var t=r(this),e=t.parents().eq(1),a=e.find(".term-link").html(),t=t.parents().eq(2).siblings('input[type="hidden"]'),n=(n=t.val()).split(","),n=r.grep(n,function(t){return t!=a});t.val(n.join(",")),e.remove()}),r("body").on("click",".term-link",function(t){return"#"!=r(this).attr("href")||(t.preventDefault(),!1)}),!1);r("body").on("click",".tagcloud-link.user-taxonomy",function(t){if(t.preventDefault(),e)return!1;if(e=!0,r(this).parent().find(".the-tagcloud").length)return r(this).parent().find(".the-tagcloud").remove(),!0;var a=r(this).attr("id"),n=a.substr(a.indexOf("-")+1);r.post(ajaxurl,{action:"get-tagcloud",tax:n},function(t,e){0!==t&&"success"==e||(t=wpAjax.broken),t=jQuery('<p id="tagcloud-'+n+'" class="the-tagcloud">'+t+"</p>"),r("a",t).click(function(){var t=r(this),e="",a=t.html(),n=t.parents().eq(2).siblings(".tagchecklist"),s=t.parents().eq(2).siblings(".newtag"),t=(0===n.length&&(n=t.parents().eq(3).siblings(".taxonomy-wrapper").find(".tagchecklist")),0===s.length&&(s=t.parents().eq(3).siblings(".taxonomy-wrapper").find(".newtag")),n.length),n=s.attr("id"),n='<div class="tag-hldr"><a href="#" class="term-link">'+a+'</a><span><a id="user_tag-'+(e=n?(n=n.split("new-tag-user_tag_"))[1]:e)+"-check-num-"+t+'" class="ntdelbutton">&#10005;</a></span></div';return insert_tags(s,e,a,n),!1}),r("#"+a).after(t)}).always(function(){e=!1})}),setInterval(function(){r("#message.below-h2").hide("slow",function(){r(".user-taxonomies-page #message.below-h2").remove()})},3e3),r(".users-php select.ut-taxonomy-filter").each(function(){""!==r(this).val()&&r("select.ut-taxonomy-filter").not(this).prop("disabled",!0)}),r(".users-php").on("change","select.ut-taxonomy-filter",function(){""===r(this).val()?r("select.ut-taxonomy-filter").prop("disabled",!1):r("select.ut-taxonomy-filter").not(this).prop("disabled",!0)}),r("#ut-taxonomy-filter").on("change",function(){if(""===r(this).val())return!1})});